<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="angular2由组件组成，每个组件都有自己的类、模板和样式。angular2通过不断地构造组件，搭建组件，复用组件来完成项目。所有项目总是会有一个组件树，所有的组件都在组件树上，父组件包含着子组件。根组件由bootstrap启动。
下面是一个典型的组件文件host.ts：12345678910111213141516171819202122232425262728293031323334impo">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular2学习笔记(2.0.0-alpha.40)">
<meta property="og:url" content="http://elona2011.github.io/2016/01/03/Angular2/index.html">
<meta property="og:site_name" content="亚木的前端之道">
<meta property="og:description" content="angular2由组件组成，每个组件都有自己的类、模板和样式。angular2通过不断地构造组件，搭建组件，复用组件来完成项目。所有项目总是会有一个组件树，所有的组件都在组件树上，父组件包含着子组件。根组件由bootstrap启动。
下面是一个典型的组件文件host.ts：12345678910111213141516171819202122232425262728293031323334impo">
<meta property="og:updated_time" content="2016-01-31T07:06:40.299Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Angular2学习笔记(2.0.0-alpha.40)">
<meta name="twitter:description" content="angular2由组件组成，每个组件都有自己的类、模板和样式。angular2通过不断地构造组件，搭建组件，复用组件来完成项目。所有项目总是会有一个组件树，所有的组件都在组件树上，父组件包含着子组件。根组件由bootstrap启动。
下面是一个典型的组件文件host.ts：12345678910111213141516171819202122232425262728293031323334impo">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Angular2学习笔记(2.0.0-alpha.40) | 亚木的前端之道 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?eeb4365c48e9e9569f2c248f69ffc563";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">亚木的前端之道</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-wiki">
          <a href="/wiki" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            menu.wiki
          </a>
        </li>
      
        
        <li class="menu-item menu-item-github">
          <a href="https://github.com/elona2011" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            menu.github
          </a>
        </li>
      
        
        <li class="menu-item menu-item-weibo">
          <a href="http://weibo.com/u/2469552951" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            menu.weibo
          </a>
        </li>
      
        
        <li class="menu-item menu-item-twitter">
          <a href="https://twitter.com/cdszbjj" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            menu.twitter
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Angular2学习笔记(2.0.0-alpha.40)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-03T23:17:12+08:00" content="2016-01-03">
              2016-01-03
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>angular2由组件组成，每个组件都有自己的类、模板和样式。angular2通过不断地构造组件，搭建组件，复用组件来完成项目。<br>所有项目总是会有一个组件树，所有的组件都在组件树上，父组件包含着子组件。根组件由bootstrap启动。</p>
<p>下面是一个典型的组件文件host.ts：<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, View &#125; from <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="keyword">import</span> &#123; RouteConfig, RouterLink, RouterOutlet &#125; from <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Search &#125; from <span class="string">'/app/recommended/recommendedNavigation/test/search'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Artist &#125; from <span class="string">'/app/recommended/recommendedNavigation/test/artist'</span>;</div><div class="line"></div><div class="line">@Component(&#123;</div><div class="line">	selector: <span class="string">'host'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">@View(&#123;</div><div class="line">	directives: [RouterLink, RouterOutlet],</div><div class="line">	template: `</div><div class="line">		&lt;header&gt;</div><div class="line">			&lt;a [router-link]=<span class="string">"['./search']"</span>&gt;Search&lt;/a&gt;</div><div class="line">		&lt;/header&gt;</div><div class="line">		&lt;main&gt;</div><div class="line">			&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">			&lt;router-outlet&gt;&lt;/router-outlet&gt;</div><div class="line">		&lt;/main&gt;`,</div><div class="line">	styleUrls: [<span class="string">'host.css'</span>]</div><div class="line">&#125;)</div><div class="line"></div><div class="line">@RouteConfig([</div><div class="line">	&#123; path: <span class="string">'/'</span>, redirectTo: <span class="string">'/search'</span> &#125;,</div><div class="line">	&#123; path: <span class="string">'/search'</span>, as: <span class="string">'search'</span>, component: Search &#125;,</div><div class="line">	&#123; path: <span class="string">'/artist/:id'</span>, as: <span class="string">'artist'</span>, component: Artist &#125;</div><div class="line">])</div><div class="line"></div><div class="line">export class Host &#123;</div><div class="line">	title: string;</div><div class="line">	constructor() &#123;</div><div class="line">		this.title = <span class="string">' title'</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1    Typescript and ES6<br>angular2采用typescript语法和ES6 ，比较常用的有：</p>
<p>1.1    箭头函数<br>chrome的调试窗口中箭头函数中的this会显示为指向Window，该显示是错误的，实际指向class</p>
<p>1.2    let<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</div><div class="line"> setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line"> &#125;,i*<span class="number">1000</span>);</div><div class="line">&#125; <span class="comment">//输出4个5</span></div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</div><div class="line"> setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line"> &#125;,i*<span class="number">1000</span>);</div><div class="line">&#125; <span class="comment">//输出1，2，3，4</span></div></pre></td></tr></table></figure></p>
<p>1.3    class<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;<span class="comment">//定义类和构造函数</span></div><div class="line">    name: string = <span class="string">'World'</span>;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        setTimeout(() =&gt; &#123;</div><div class="line">          <span class="keyword">this</span>.name = <span class="string">'NEW World'</span></div><div class="line">        &#125;, <span class="number">2000</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Constructor构造函数，初始化数据</p>
<p>参考：<br><a href="http://www.typescriptlang.org/Handbook" target="_blank" rel="external">http://www.typescriptlang.org/Handbook</a><br><a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">http://es6.ruanyifeng.com/</a></p>
<p>2    import,export<br>import引入依赖的模块及自定义组件<br>例1：<code>import {ComponentMetadata as Component, ViewMetadata as View, bootstrap, CORE_DIRECTIVES } from &#39;angular2/angular2&#39;;</code><br>例2：<code>import {Zippy} from &#39;zippy&#39;;</code></p>
<p>export输出组件和函数<br>例1：<code>export class Search {}</code><br>例2：<code>export function status(response) {...}</code></p>
<p>2.1    依赖关系<br>FORM_DIRECTIVES:ng-model<br>ROUTER_DIRECTIVES:<router-outlet><br>CORE_DIRECTIVES:NgIf, NgFor, Pipe, OnInit        包含所有CORE里的指令<br>例1：<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component, View, CORE_DIRECTIVES, NgStyle&#125; from <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="meta">@View(&#123;</span></div><div class="line">	directives: [CORE_DIRECTIVES, NgStyle]</div><div class="line">&#125;)</div></pre></td></tr></table></figure></router-outlet></p>
<p>例2：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component, View, EventEmitter&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="keyword">import</span> &#123;FORM_DIRECTIVES&#125; <span class="keyword">from</span> <span class="string">'angular2/forms'</span>;</div><div class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; RouterLink &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ROUTER_DIRECTIVES, RouteConfig &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ROUTER_BINDINGS, LocationStrategy, HashLocationStrategy &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div></pre></td></tr></table></figure></p>
<p>3    @Component组件<br>3.1    selector<br>组件名称。<br>例：<code>selector: &#39;zippy&#39;,</code><br>3.2    properties<br>申明组件的外部属性,其它组件可以通过这个属性传入参数。<br>例1：<code>properties:[&#39;myTitle1&#39;,’myTitle2’]</code><br>例2：<code>&lt;zippy [my-title1]=&quot;title2&quot;&gt;&lt;/zippy&gt;</code> 绑定title2变量<br>例3：<code>&lt;zippy [my-title2] = &quot;’title2’&quot;&gt;&lt;/zippy&gt;</code> 绑定title2字符串<br>例4：<code>[&#39;tabTitle: tab-title&#39;]</code>申明变量tabTitle,将tab-title绑定到组件内的tabTitle变量上。内部绑定的优先级高于外部绑定，例如例4的绑定高于例2的绑定。<br>3.3    events<br>申明事件。<br>例：<code>events: [&#39;open&#39;, &#39;close&#39;],</code></p>
<p>3.4 host<br>内部事件。<br>例1：<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">host: &#123;</div><div class="line">    <span class="string">'(mouseenter)'</span>: 'focusElement(<span class="string">"77"</span>)'</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>例2：内部绑定和外部绑定的相互切换。一个属性同时在template和组件class中绑定，只要有其中一个值改变，属性值就会刷新。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;View, Component, bootstrap, Directive, Host, Optional&#125; from <span class="string">'angular2/angular2'</span></div><div class="line"></div><div class="line"><span class="meta">@Component(&#123;</span></div><div class="line">  selector: <span class="meta-string">'bank-account'</span>,</div><div class="line">  properties: [<span class="meta-string">'bankName:bank-name'</span>, <span class="meta-string">'id: account-id'</span>],</div><div class="line">  host: &#123;</div><div class="line">    <span class="meta-string">'(mouseout)'</span>: <span class="meta-string">'focusElement("77")'</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="meta">@View(&#123;</span></div><div class="line">  template: `</div><div class="line">    Bank Name: &#123;&#123;bankName&#125;&#125;</div><div class="line">    Account Id: &#123;&#123;id&#125;&#125;</div><div class="line">  `</div><div class="line">&#125;)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span> </span>&#123;</div><div class="line">  bankName: string;</div><div class="line">  id: string;</div><div class="line">  </div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">this</span>.bankName = <span class="string">"222"</span>;</div><div class="line">  &#125;</div><div class="line">  focusElement(isFocus) &#123;</div><div class="line">    <span class="keyword">this</span>.bankName = isFocus;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// this property is not bound, and won't be automatically updated by Angular</span></div><div class="line">  normalizedBankName: string;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Component(&#123;selector: <span class="meta-string">'app'</span>&#125;)</span></div><div class="line"><span class="meta">@View(&#123;</span></div><div class="line">  template: `</div><div class="line">    &lt;bank-account [bank-name]=<span class="meta-string">"RBC1"</span> account-id=<span class="meta-string">"4747"</span> (click)=<span class="string">"onclick()"</span>&gt;&lt;/bank-account&gt;</div><div class="line">  `,</div><div class="line">  directives: [BankAccount]</div><div class="line">&#125;)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</div><div class="line">  RBC1: string;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">this</span>.RBC1 = <span class="string">"2221"</span>;</div><div class="line">  &#125;</div><div class="line">  onclick()&#123;</div><div class="line">    <span class="keyword">this</span>.RBC1 = <span class="keyword">this</span>.RBC1+<span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">bootstrap(App);</div></pre></td></tr></table></figure></p>
<p>3.5 bindings<br>绑定依赖，先要import该依赖。绑定可供子模块查询。<br>例：<code>bindings: [IptvService, AuthenticateService]</code></p>
<p>3.6 viewBindings<br><code>viewBindings:[bind(VideoService).toClass(SpecificVideoService)]</code>  绑定的对象只能供本模块使用，不会影响到子模块</p>
<p>4 @View视图<br>4.1 directives<br>template中用到的angular指令和自定义指令，camel驼峰写法。<br>例：<code>directives: [EzCard],</code></p>
<p>4.2 template<br>该视图的模板，html代码。directives要用小写中划线写法。<br>例：<code>template: ‘&lt; ez-card [title1]=&quot;&#39;deeeeeeee&#39;&quot;&gt;&lt;/ ez-card &gt;’,</code></p>
<p>HTML元素属性的几种写法：<br><code>title=&quot;Details&quot;</code>：title属性为字符串Details<br><code>[title]=&quot;&#39;Details&#39;&quot;</code>： title属性为字符串Details<br><code>[title]=&quot;Details&quot;</code>： title属性为变量Details<br><code>bind-title=”’Details’”</code>： title属性为字符串Details</p>
<p> <code>&lt;input #searchvalue (keyup)=&quot;searchArtist($event, searchvalue.value)&quot;/&gt;</code> #searchvalue会双向绑定到input对象上，searchvalue.value可实时更新input输入值</p>
<p>4.3 templateUrl<br>模板地址，引入外部HTML文件。例：<code>templateUrl: &#39;zippy.html&#39;</code></p>
<p>4.4 styles<br><code>styles: [&#39;.tabs1 {background-color: green;}&#39;,&#39;{...}&#39;],</code> 声明的样式只在本组件中可用，默认，取决于encapsulation</p>
<p>4.5 styleUrls<br><code>styleUrls: [&#39;zippy.css&#39;],</code> 声明外部样式文件<br>此外还可以直接写在template中，多用于关联动态样式，如生成动态获取的背景图片</p>
<p>下面有导致hexo出错的BUG</p>
<p>4.6 encapsulation<br>封装设置。<br>ViewEncapsulation.None 无样式封装，样式位于<head>中，将全局可用。<br>ViewEncapsulation.Emulated 样式模拟，样式位于<head>中，仅当前组件可用，默认。<br>ViewEncapsulation.Native 当前组件可用，样式位于组件中，仅当前组件可用。</head></head></p>
<p>5 @Directive<br><a href="https://github.com/angular/angular/blob/master/modules/angular2/docs/core/02_directives.md" target="_blank" rel="external">https://github.com/angular/angular/blob/master/modules/angular2/docs/core/02_directives.md</a></p>
<p>6 常用指令<br>6.1 #<br>定义一个当前组件的局部变量，绑定当前位置的HTML元素，变量名只能小写<br>例1：<code>&lt;input #searchvalue (keyup)=&quot;searchArtist(searchvalue.value)&quot;/&gt;</code><br>例2：<code>&lt;input class=&quot;form-control&quot; type=&quot;text&quot; placeholder=&quot;Your new friend&quot; #friend (keyup) =&quot;update(friend.value)&quot;&gt;</code></p>
<p>6.2 \{\{\}\}</p>
<p>动态变量或表达式<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">例<span class="number">1</span>：``&#123;&#123;i<span class="meta">%6</span>&#125;&#125;``</div><div class="line">例<span class="number">2</span>：``&lt;div&gt;&#123;&#123;visible?<span class="string">'&amp;blacktriangledown;'</span>:<span class="string">'&amp;blacktriangleright;'</span>&#125;&#125;&lt;/div&gt;``</div></pre></td></tr></table></figure></p>
<p>6.3 <code>[]</code><br>[参数]用于父组件向子组件传递参数，(事件)用于子组件向父组件传递事件。<br>例：<code>&lt;todo-cmp [model]=&quot;todo&quot; (complete)=&quot;onCompletingTodo(todo)&quot;&gt;&lt;/todo-cmp&gt;</code> 其中model是子组件中定义的参数，todo是父组件中的变量，如果todo改变，model也会自动改变；complete是子组件中定义的事件，onCompletingTodo是父组件中的方法，complete事件将触发onCompletingTodo方法。</p>
<p>6.4 ng-for<br>例：<code>&lt;div *ng-for=&quot;#content of contentList; #i= index&quot;&gt;</code><br>contentList为将遍历的数组，#content为遍历数组的元素，#i为数组指针。在当前div及其子元素可用<code><p>angular2由组件组成，每个组件都有自己的类、模板和样式。angular2通过不断地构造组件，搭建组件，复用组件来完成项目。<br>所有项目总是会有一个组件树，所有的组件都在组件树上，父组件包含着子组件。根组件由bootstrap启动。</p>
<p>下面是一个典型的组件文件host.ts：<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, View &#125; from <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="keyword">import</span> &#123; RouteConfig, RouterLink, RouterOutlet &#125; from <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Search &#125; from <span class="string">'/app/recommended/recommendedNavigation/test/search'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Artist &#125; from <span class="string">'/app/recommended/recommendedNavigation/test/artist'</span>;</div><div class="line"></div><div class="line">@Component(&#123;</div><div class="line">	selector: <span class="string">'host'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">@View(&#123;</div><div class="line">	directives: [RouterLink, RouterOutlet],</div><div class="line">	template: `</div><div class="line">		&lt;header&gt;</div><div class="line">			&lt;a [router-link]=<span class="string">"['./search']"</span>&gt;Search&lt;/a&gt;</div><div class="line">		&lt;/header&gt;</div><div class="line">		&lt;main&gt;</div><div class="line">			&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">			&lt;router-outlet&gt;&lt;/router-outlet&gt;</div><div class="line">		&lt;/main&gt;`,</div><div class="line">	styleUrls: [<span class="string">'host.css'</span>]</div><div class="line">&#125;)</div><div class="line"></div><div class="line">@RouteConfig([</div><div class="line">	&#123; path: <span class="string">'/'</span>, redirectTo: <span class="string">'/search'</span> &#125;,</div><div class="line">	&#123; path: <span class="string">'/search'</span>, as: <span class="string">'search'</span>, component: Search &#125;,</div><div class="line">	&#123; path: <span class="string">'/artist/:id'</span>, as: <span class="string">'artist'</span>, component: Artist &#125;</div><div class="line">])</div><div class="line"></div><div class="line">export class Host &#123;</div><div class="line">	title: string;</div><div class="line">	constructor() &#123;</div><div class="line">		this.title = <span class="string">' title'</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1    Typescript and ES6<br>angular2采用typescript语法和ES6 ，比较常用的有：</p>
<p>1.1    箭头函数<br>chrome的调试窗口中箭头函数中的this会显示为指向Window，该显示是错误的，实际指向class</p>
<p>1.2    let<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</div><div class="line"> setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line"> &#125;,i*<span class="number">1000</span>);</div><div class="line">&#125; <span class="comment">//输出4个5</span></div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</div><div class="line"> setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line"> &#125;,i*<span class="number">1000</span>);</div><div class="line">&#125; <span class="comment">//输出1，2，3，4</span></div></pre></td></tr></table></figure></p>
<p>1.3    class<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;<span class="comment">//定义类和构造函数</span></div><div class="line">    name: string = <span class="string">'World'</span>;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        setTimeout(() =&gt; &#123;</div><div class="line">          <span class="keyword">this</span>.name = <span class="string">'NEW World'</span></div><div class="line">        &#125;, <span class="number">2000</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Constructor构造函数，初始化数据</p>
<p>参考：<br><a href="http://www.typescriptlang.org/Handbook" target="_blank" rel="external">http://www.typescriptlang.org/Handbook</a><br><a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">http://es6.ruanyifeng.com/</a></p>
<p>2    import,export<br>import引入依赖的模块及自定义组件<br>例1：<code>import {ComponentMetadata as Component, ViewMetadata as View, bootstrap, CORE_DIRECTIVES } from &#39;angular2/angular2&#39;;</code><br>例2：<code>import {Zippy} from &#39;zippy&#39;;</code></p>
<p>export输出组件和函数<br>例1：<code>export class Search {}</code><br>例2：<code>export function status(response) {...}</code></p>
<p>2.1    依赖关系<br>FORM_DIRECTIVES:ng-model<br>ROUTER_DIRECTIVES:<router-outlet><br>CORE_DIRECTIVES:NgIf, NgFor, Pipe, OnInit        包含所有CORE里的指令<br>例1：<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component, View, CORE_DIRECTIVES, NgStyle&#125; from <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="meta">@View(&#123;</span></div><div class="line">	directives: [CORE_DIRECTIVES, NgStyle]</div><div class="line">&#125;)</div></pre></td></tr></table></figure></router-outlet></p>
<p>例2：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component, View, EventEmitter&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="keyword">import</span> &#123;FORM_DIRECTIVES&#125; <span class="keyword">from</span> <span class="string">'angular2/forms'</span>;</div><div class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; RouterLink &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ROUTER_DIRECTIVES, RouteConfig &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ROUTER_BINDINGS, LocationStrategy, HashLocationStrategy &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div></pre></td></tr></table></figure></p>
<p>3    @Component组件<br>3.1    selector<br>组件名称。<br>例：<code>selector: &#39;zippy&#39;,</code><br>3.2    properties<br>申明组件的外部属性,其它组件可以通过这个属性传入参数。<br>例1：<code>properties:[&#39;myTitle1&#39;,’myTitle2’]</code><br>例2：<code>&lt;zippy [my-title1]=&quot;title2&quot;&gt;&lt;/zippy&gt;</code> 绑定title2变量<br>例3：<code>&lt;zippy [my-title2] = &quot;’title2’&quot;&gt;&lt;/zippy&gt;</code> 绑定title2字符串<br>例4：<code>[&#39;tabTitle: tab-title&#39;]</code>申明变量tabTitle,将tab-title绑定到组件内的tabTitle变量上。内部绑定的优先级高于外部绑定，例如例4的绑定高于例2的绑定。<br>3.3    events<br>申明事件。<br>例：<code>events: [&#39;open&#39;, &#39;close&#39;],</code></p>
<p>3.4 host<br>内部事件。<br>例1：<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">host: &#123;</div><div class="line">    <span class="string">'(mouseenter)'</span>: 'focusElement(<span class="string">"77"</span>)'</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>例2：内部绑定和外部绑定的相互切换。一个属性同时在template和组件class中绑定，只要有其中一个值改变，属性值就会刷新。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;View, Component, bootstrap, Directive, Host, Optional&#125; from <span class="string">'angular2/angular2'</span></div><div class="line"></div><div class="line"><span class="meta">@Component(&#123;</span></div><div class="line">  selector: <span class="meta-string">'bank-account'</span>,</div><div class="line">  properties: [<span class="meta-string">'bankName:bank-name'</span>, <span class="meta-string">'id: account-id'</span>],</div><div class="line">  host: &#123;</div><div class="line">    <span class="meta-string">'(mouseout)'</span>: <span class="meta-string">'focusElement("77")'</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="meta">@View(&#123;</span></div><div class="line">  template: `</div><div class="line">    Bank Name: &#123;&#123;bankName&#125;&#125;</div><div class="line">    Account Id: &#123;&#123;id&#125;&#125;</div><div class="line">  `</div><div class="line">&#125;)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span> </span>&#123;</div><div class="line">  bankName: string;</div><div class="line">  id: string;</div><div class="line">  </div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">this</span>.bankName = <span class="string">"222"</span>;</div><div class="line">  &#125;</div><div class="line">  focusElement(isFocus) &#123;</div><div class="line">    <span class="keyword">this</span>.bankName = isFocus;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// this property is not bound, and won't be automatically updated by Angular</span></div><div class="line">  normalizedBankName: string;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Component(&#123;selector: <span class="meta-string">'app'</span>&#125;)</span></div><div class="line"><span class="meta">@View(&#123;</span></div><div class="line">  template: `</div><div class="line">    &lt;bank-account [bank-name]=<span class="meta-string">"RBC1"</span> account-id=<span class="meta-string">"4747"</span> (click)=<span class="string">"onclick()"</span>&gt;&lt;/bank-account&gt;</div><div class="line">  `,</div><div class="line">  directives: [BankAccount]</div><div class="line">&#125;)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</div><div class="line">  RBC1: string;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">this</span>.RBC1 = <span class="string">"2221"</span>;</div><div class="line">  &#125;</div><div class="line">  onclick()&#123;</div><div class="line">    <span class="keyword">this</span>.RBC1 = <span class="keyword">this</span>.RBC1+<span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">bootstrap(App);</div></pre></td></tr></table></figure></p>
<p>3.5 bindings<br>绑定依赖，先要import该依赖。绑定可供子模块查询。<br>例：<code>bindings: [IptvService, AuthenticateService]</code></p>
<p>3.6 viewBindings<br><code>viewBindings:[bind(VideoService).toClass(SpecificVideoService)]</code>  绑定的对象只能供本模块使用，不会影响到子模块</p>
<p>4 @View视图<br>4.1 directives<br>template中用到的angular指令和自定义指令，camel驼峰写法。<br>例：<code>directives: [EzCard],</code></p>
<p>4.2 template<br>该视图的模板，html代码。directives要用小写中划线写法。<br>例：<code>template: ‘&lt; ez-card [title1]=&quot;&#39;deeeeeeee&#39;&quot;&gt;&lt;/ ez-card &gt;’,</code></p>
<p>HTML元素属性的几种写法：<br><code>title=&quot;Details&quot;</code>：title属性为字符串Details<br><code>[title]=&quot;&#39;Details&#39;&quot;</code>： title属性为字符串Details<br><code>[title]=&quot;Details&quot;</code>： title属性为变量Details<br><code>bind-title=”’Details’”</code>： title属性为字符串Details</p>
<p> <code>&lt;input #searchvalue (keyup)=&quot;searchArtist($event, searchvalue.value)&quot;/&gt;</code> #searchvalue会双向绑定到input对象上，searchvalue.value可实时更新input输入值</p>
<p>4.3 templateUrl<br>模板地址，引入外部HTML文件。例：<code>templateUrl: &#39;zippy.html&#39;</code></p>
<p>4.4 styles<br><code>styles: [&#39;.tabs1 {background-color: green;}&#39;,&#39;{...}&#39;],</code> 声明的样式只在本组件中可用，默认，取决于encapsulation</p>
<p>4.5 styleUrls<br><code>styleUrls: [&#39;zippy.css&#39;],</code> 声明外部样式文件<br>此外还可以直接写在template中，多用于关联动态样式，如生成动态获取的背景图片</p>
<p>下面有导致hexo出错的BUG</p>
<p>4.6 encapsulation<br>封装设置。<br>ViewEncapsulation.None 无样式封装，样式位于<head>中，将全局可用。<br>ViewEncapsulation.Emulated 样式模拟，样式位于<head>中，仅当前组件可用，默认。<br>ViewEncapsulation.Native 当前组件可用，样式位于组件中，仅当前组件可用。</head></head></p>
<p>5 @Directive<br><a href="https://github.com/angular/angular/blob/master/modules/angular2/docs/core/02_directives.md" target="_blank" rel="external">https://github.com/angular/angular/blob/master/modules/angular2/docs/core/02_directives.md</a></p>
<p>6 常用指令<br>6.1 #<br>定义一个当前组件的局部变量，绑定当前位置的HTML元素，变量名只能小写<br>例1：<code>&lt;input #searchvalue (keyup)=&quot;searchArtist(searchvalue.value)&quot;/&gt;</code><br>例2：<code>&lt;input class=&quot;form-control&quot; type=&quot;text&quot; placeholder=&quot;Your new friend&quot; #friend (keyup) =&quot;update(friend.value)&quot;&gt;</code></p>
<p>6.2 \{\{\}\}</p>
<p>动态变量或表达式<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">例<span class="number">1</span>：``&#123;&#123;i<span class="meta">%6</span>&#125;&#125;``</div><div class="line">例<span class="number">2</span>：``&lt;div&gt;&#123;&#123;visible?<span class="string">'&amp;blacktriangledown;'</span>:<span class="string">'&amp;blacktriangleright;'</span>&#125;&#125;&lt;/div&gt;``</div></pre></td></tr></table></figure></p>
<p>6.3 <code>[]</code><br>[参数]用于父组件向子组件传递参数，(事件)用于子组件向父组件传递事件。<br>例：<code>&lt;todo-cmp [model]=&quot;todo&quot; (complete)=&quot;onCompletingTodo(todo)&quot;&gt;&lt;/todo-cmp&gt;</code> 其中model是子组件中定义的参数，todo是父组件中的变量，如果todo改变，model也会自动改变；complete是子组件中定义的事件，onCompletingTodo是父组件中的方法，complete事件将触发onCompletingTodo方法。</p>
<p>6.4 ng-for<br>例：<code>&lt;div *ng-for=&quot;#content of contentList; #i= index&quot;&gt;</code><br>contentList为将遍历的数组，#content为遍历数组的元素，#i为数组指针。在当前div及其子元素可用<code>{{content}}</code>和<code>{{i}}</code>进行引用<br>6.5 ng-if<br>当*ng-if之后的表达式为true，则显示该HTML元素；反之则删除。显示删除过程会触发Lifecycle<br>例：<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  &lt;<span class="keyword">btv-player-menu </span>*ng-<span class="meta">if</span>=<span class="string">"isShowBtvPlayerMenu"</span>&gt;&lt;/<span class="keyword">btv-player-menu&gt;</span></div><div class="line">  &lt;<span class="keyword">btv-player-minidetail-page </span>*ng-<span class="meta">if</span>=<span class="string">"isShowBtvPlayerMinidetailPage"</span>&gt;&lt;/<span class="keyword">btv-player-minidetail-page&gt;</span></div><div class="line">  &lt;<span class="keyword">btv-player-reminder </span>*ng-<span class="meta">if</span>=<span class="string">"isShowBtvPlayerReminder"</span>&gt;&lt;/<span class="keyword">btv-player-reminder&gt;</span></div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>6.6 ng-switch</p>
<p>6.7 ng-model</p>
<p>6.8 ng-style<br>例1：<code>&lt;div [ng-style]=&quot;{&#39;background-image&#39;:&#39;url(&#39;+picture+&#39;)&#39;}&quot;&gt;&lt;/div&gt;</code> 背景图绑定picture变量，picture为图片地址<br>例2：<code>&lt;div [ng-style]=&quot;{&#39;text-align&#39;: alignExp}&quot;&gt;&lt;/div&gt;</code><br>例3：<code>&lt;div [ng-style]=&quot;styleExp&quot;&gt;&lt;/div&gt;</code>  可以是变量</p>
<p>6.9 ng-class<br>根据表达式的结果添加或移除CSS属性<br>例：<code>&lt;div class=&quot;button&quot; [ng-class]=&quot;{active: isOn, disabled: isDisabled}&quot;&gt;</code></p>
<p>6.10  ng-content<br><code>&lt;ng-content&gt;&lt;/ng-content&gt;</code>表明其它组件或内容插入当前组件的位置。<br>例：<code>&lt;zippy&gt;&lt;p&gt;111&lt;/p&gt;&lt;/zippy&gt;</code>，其中<code>&lt;p&gt;111&lt;/p&gt;</code>将插入zippy组件的template中的ng-content位置。</p>
<p>6.11  router-outlet<br>router的输出位置。</p>
<p>6.12  router-link<br>router-link表示跳转名称为search的地址，而不是跳转到/search的url下，见@RouteConfig。<br>有三种写法：<br>例1：<code>[router-link]=&quot;[&#39;./search&#39;]&quot;</code> search位于当前组件路径下<br>例2：<code>[router-link]=&quot;[&#39;../search&#39;]&quot;</code>  search位于当前组件的父路径下<br>例3：<code>[router-link]=&quot;[&#39;/search&#39;]&quot;</code>  绝对路径，从根路径开始<br>还可以传递参数：<br>例4：<code>[router-link] =”[&#39;/team&#39;, {teamId: 1}, &#39;user&#39;, {userId: 2}]”</code></p>
<p>6.13  Pipe<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Pipe&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>2.根据Pipe设定变量类型<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> starttime: number = <span class="number">0</span>;</div><div class="line"><span class="keyword">public</span> endtime: number = <span class="number">0</span>;</div><div class="line"><span class="keyword">this</span>.starttime = parseInt(<span class="keyword">this</span>.playbilllist.playbilllist[<span class="number">0</span>].startTimeMilli);</div><div class="line"><span class="keyword">this</span>.endtime = parseInt(<span class="keyword">this</span>.playbilllist.playbilllist[<span class="number">0</span>].endTimeMilli);</div></pre></td></tr></table></figure></p>
<p>3.使用Pipe设定时间<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">div</span>&gt;&#123;&#123;starttime | <span class="keyword">date</span>:<span class="string">'HHmm'</span>&#125;&#125; - &#123;&#123;endtime | <span class="keyword">date</span>:<span class="string">'HHmm'</span>&#125;&#125;&lt;/<span class="keyword">div</span>&gt;</div></pre></td></tr></table></figure></p>
<p>参考：<br><a href="http://www.shmck.com/angular-2-pipes/" target="_blank" rel="external">http://www.shmck.com/angular-2-pipes/</a><br><a href="https://github.com/auth0/angular2-pipes" target="_blank" rel="external">https://github.com/auth0/angular2-pipes</a></p>
<p>7 bootstrap<br>启动Main程序，[]中的绑定将全局可用<br>例：bootstrap(App, []);<br>8 inject<br>1.template中，注入的类为父子关系<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;pet-list &gt;</span></div><div class="line"><span class="section">&lt;pet-input&gt;</span><span class="section">&lt;/pet-input&gt;</span></div><div class="line"><span class="section">&lt;/pet-list&gt;</span></div></pre></td></tr></table></figure></p>
<p>2.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;PetList&#125; <span class="keyword">from</span> <span class="string">'byinjection/PetList'</span>;</div><div class="line"><span class="keyword">import</span> &#123; <span class="keyword">Inject</span>, forwardRef&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>3.class注入，调用注入class的方法<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">export <span class="class"><span class="keyword">class</span> <span class="title">PetInput</span> </span>&#123;</div><div class="line">  petList: PetList;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>(<span class="meta">@Inject(forwardRef(()</span>=&gt;PetList)) petList:PetList) &#123; <span class="comment">//petList为单例，指向dom树中的&lt;pet-list&gt;</span></div><div class="line">    <span class="keyword">this</span>.petList = petList;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  doSomeThing()&#123;</div><div class="line">  <span class="keyword">this</span>.petList.addItem(...); <span class="comment">//调用petList的方法，可以传参</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>参考：<br><a href="https://github.com/SekibOmazic/angular2-playground" target="_blank" rel="external">https://github.com/SekibOmazic/angular2-playground</a><br><a href="http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" rel="external">http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html</a></p>
<p>9 事件<br>9.1 系统事件<br>click事件<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div (<span class="name">click</span>)=<span class="string">"toggle()"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>(click)监听click事件<br>toggle()事件触发函数<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="selector-tag">div</span> [hidden]=<span class="string">"!visible"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>[hidden] 中括号将HTML元素或组件的属性绑定到组件模型的某个表达式，当表达式的值变化时，对应的DOM对象将自动得到更新。<br>visible为对应class中定义的变量<br>keyup事件<br>例：<code>&lt;input class=&quot;form-control&quot; type=&quot;text&quot; placeholder=&quot;Your new friend&quot; #friend (keyup) =&quot;update(friend.value)&quot;&gt;</code><br>键盘事件<br>1.document方法：<br>将下面代码加入class的constructor中<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (event.keyCode) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">38</span>:</div><div class="line">      alert(<span class="string">'clear'</span>);</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2.window方法：<br>将下面代码加入class的constructor中</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"keydown"</span>,<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="regexp">//</span><span class="number">1</span>、显示miniepg</div><div class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.event &amp;&amp; <span class="built_in">window</span>.event.which === <span class="number">73</span>) &#123;</div><div class="line"><span class="keyword">this</span>.showFlag = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line">&#125;, <span class="literal">true</span>);</div></pre></td></tr></table></figure>
<p>3.Angular2方法：<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;KeyEventsPlugin&#125; <span class="keyword">from</span> <span class="string">'angular2/src/core/render/dom/events/key_events'</span>;</div></pre></td></tr></table></figure></p>
<p>2.template中修改需要加入键盘事件的HTML元素，使用时该元素要先获得焦点<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div (<span class="name">keyup</span>) =<span class="string">"onKeyDown($event)"</span> tabindex=<span class="string">"0"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>3.class中加入以下方法，取得的lastKey为字符串<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">onKeyDown(<span class="keyword">event</span>): <span class="keyword">void</span> &#123;</div><div class="line">  <span class="keyword">this</span>.lastKey = KeyEventsPlugin.getEventFullKey(<span class="keyword">event</span>);</div><div class="line">  <span class="keyword">event</span>.preventDefault();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>9.2 自定义事件<br>1.引入依赖<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component, View, EventEmitter&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>2.@Component声明<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@Component</span>(&#123;</div><div class="line">    <span class="attribute">selector</span>: <span class="string">'zippy'</span>,</div><div class="line">    <span class="attribute">events</span>: [<span class="string">'open'</span>, <span class="string">'close'</span>]</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>3.class类里定义事件变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Zippy</span> </span>&#123;</div><div class="line"><span class="keyword">constructor</span>() &#123;</div><div class="line">  <span class="keyword">this</span>.open = <span class="keyword">new</span> EventEmitter();</div><div class="line">  <span class="keyword">this</span>.close = <span class="keyword">new</span> EventEmitter();&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>4.触发方法<br>toggle()方法执行，将触发事件：<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">toggle() &#123;</div><div class="line">      (<span class="keyword">this</span>.visible)?<span class="keyword">this</span>.<span class="keyword">open</span>.next(&#123;src:’<span class="number">111</span>’&#125;):<span class="keyword">this</span>.close.next();</div><div class="line">    &#125;</div><div class="line">&#123;src:’<span class="number">111</span>’&#125;为事件传参，在下面的$event会收到这个参数</div></pre></td></tr></table></figure></p>
<p>5.使用该组件事件<br><figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;zippy (<span class="keyword">open</span>)=<span class="string">"sayOpen($event)"</span> (<span class="keyword">close</span>)=<span class="string">"sayClose()"</span>&gt;&lt;/zippy&gt;</div><div class="line"><span class="built_in">$event</span>为事件传入参数</div></pre></td></tr></table></figure></p>
<p>(open)可写为on-open，(close)可写为on-close</p>
<p>事件从组件内部发送到组件上，从而可以调用其它组件的方法：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">gadget-input</span> (<span class="attr">store</span>)=<span class="string">"gadget.onAddItem($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">gadget-input</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">gadget-list</span> #<span class="attr">gadget</span>&gt;</span><span class="tag">&lt;/<span class="name">gadget-list</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>9.3 Observer事件<br>1.引用依赖<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;ObservableComponent&#125; <span class="keyword">from</span> <span class="string">'base/core/ObservableComponent'</span>;</div><div class="line"><span class="keyword">import</span> &#123;Event&#125; <span class="keyword">from</span> <span class="string">'base/core/Event'</span>;</div></pre></td></tr></table></figure></p>
<p>2.定义一个类<br>重写listNotificationInterests，返回一个数组包括所有事件名<br>用Event.getInstance().on方法设置所有事件的回调函数<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyEvent</span> <span class="keyword">extends</span> <span class="title">ObservableComponent</span>&#123;</span></div><div class="line">  constructor()&#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="keyword">super</span>.onInit();</div><div class="line">    Event.getInstance().<span class="literal">on</span>(<span class="string">"aaa"</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">"I'm aaa"</span>) &#125;);</div><div class="line">    Event.getInstance().<span class="literal">on</span>(<span class="string">"bbb"</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">"I'm bbb"</span>) &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  listNotificationInterests() &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">"aaa"</span>, <span class="string">"bbb"</span>];</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3.生成一个实例<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(iptvService: IptvService)</span> <span class="comment">&#123;</span></span></div><div class="line">    this.MyEvent = new MyEvent();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4.调用函数发事件<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">emitTest</span>()&#123;</div><div class="line">    Event<span class="selector-class">.getInstance</span>()<span class="selector-class">.emit</span>(<span class="string">"bbb"</span>);</div><div class="line">    Event<span class="selector-class">.getInstance</span>()<span class="selector-class">.emit</span>(<span class="string">"aaa"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>9.4 Lifecycle<br>Lifecycle可以看作是组件自带的系统事件，在组件运行的关键时间点可添加处理函数，alpha.37改为如下写法请注意。<br>例：<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;OnInit, OnDestroy&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>2.重写相关Lifecycle方法<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">export</span> <span class="selector-tag">class</span> <span class="selector-tag">About</span> <span class="selector-tag">implements</span> <span class="selector-tag">OnInit</span>, <span class="selector-tag">OnDestroy</span> &#123;</div><div class="line">  <span class="selector-tag">onInit</span>()&#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="selector-tag">onDestroy</span>()&#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>10  Router<br>10.1  router策略<br><code>bind(LocationStrategy).toClass(HashLocationStrategy)</code> 使用hash url定位策略<br><code>bind(LocationStrategy).toClass(PathLocationStrategy)</code> 需在index.html的<head>中加入<base href="/"></head></p>
<p>10.2  @RouteConfig<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RouteConfig</span>([</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/'</span>, <span class="string">redirectTo:</span> <span class="string">'/search'</span> &#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/search'</span>, <span class="string">as:</span> <span class="string">'search'</span>, <span class="string">component:</span> Search &#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/artist/:id'</span>, <span class="string">as:</span> <span class="string">'artist'</span>, <span class="string">component:</span> Artist &#125;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<p>path: ‘/‘为默认路径。<br>redirectTo：跳转到其它路径<br>as：路径的别名，用于[router-link]中引用<br>component：引用的组件类名</p>
<p>10.3  router设置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span><span class="keyword">import</span> &#123; ROUTER_BINDINGS, LocationStrategy, HashLocationStrategy, PathLocationStrategy &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123;bind&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ROUTER_DIRECTIVES, RouteConfig, RouterLink &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line">bootstrap(App, [ROUTER-BINDINGS, bind(LocationStrategy).toClass(HashLocationStrategy)]);</div><div class="line"></div><div class="line"><span class="number">2.</span>@RouteConfig([</div><div class="line">    &#123;path:<span class="string">'/'</span>, component:Start, <span class="keyword">as</span>: <span class="string">'start'</span>&#125;</div><div class="line">])</div><div class="line"><span class="number">3.</span>&lt;router-outlet&gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span></div><div class="line">directives: [ROUTER_DIRECTIVES, RouterLink]</div><div class="line"></div><div class="line">4.<span class="tag">&lt;<span class="name">a</span> [<span class="attr">router-link</span>]=<span class="string">"['./user']"</span>&gt;</span>link to user component<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>10.4  router跳转<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Router&#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div></pre></td></tr></table></figure></p>
<p>2.constructor注入<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(..., <span class="keyword">public</span> router: Router)</span> <span class="comment">&#123;</span></span></div><div class="line">    ...</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>url跳转方法<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.router.navigateByUrl(<span class="string">'/home/livetv'</span>);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>10.5  父子路由<br>1、  针对父—子路由：<br>父路由配置（在父ts文件下）：<br>  （1）、导入路由所需组件：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Router, RouteConfig, ROUTER_DIRECTIVES, ROUTER_BINDINGS &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div></pre></td></tr></table></figure></p>
<p>  （2）、配置路由：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RouteConfig</span>([</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/'</span>, <span class="string">redirectTo:</span> <span class="string">'/login/userlogin'</span> &#125;,   <span class="comment">// redirectTo默认页面</span></div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/login/...'</span>, <span class="string">component:</span> Login, <span class="string">as:</span> <span class="string">'login'</span> &#125;,  <span class="comment">// component为导入的组件</span></div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/mytvNavigation/...'</span>, <span class="string">component:</span> MyTVNavigation, <span class="string">as:</span> <span class="string">'mytvNavigation'</span> &#125;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<p>子路由配置（子ts文件中）：<br>  （1）、同上；<br>  （2）、配置路由：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RouteConfig</span>([</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/mytvNavigation'</span>, <span class="string">redirectTo:</span> <span class="string">'/history'</span>&#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/history'</span>, <span class="string">component:</span> History, <span class="string">as:</span> <span class="string">'history'</span>&#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/favorite'</span>, <span class="string">component:</span> Favorite, <span class="string">as:</span> <span class="string">'favorite'</span> &#125;,</div><div class="line">&#123; <span class="string">path:</span> <span class="string">'/profile/...'</span>, <span class="string">component:</span> Profile, <span class="string">as:</span> <span class="string">'profile'</span>&#125;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<p>其中path最好写上父路由路径，如果不写，在页面跳转时要加上父路径的path。<br>如果子路由下还存在子路由（如profile），以此类推……<br>注：凡是配置路由的ts文件，其<code>@View{}</code>中必须配置路由出口<code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>，否则即使url地址变化，页面内容还是显示不出或者跳转不了！！！！<br>路由出口需要的组件：ROUTER_DIRECTIVES / RouterOutlet</p>
<p>11  Service服务<br>service是单例，数据共享给所有使用者<br>11.1  自定义Service<br>使用服务的4步，包括定义、引入、绑定、使用<br>1.定义Service<br>在angular2中，服务就是一个类。例：自定义一个简单的服务：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">DataService</span> </span>&#123;</div><div class="line">  items:<span class="built_in">Array</span>&lt;any&gt;;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.items = [</div><div class="line">      &#123; name: <span class="string">'Christoph Burgdorf'</span> &#125;,</div><div class="line">      &#123; name: <span class="string">'Pascal Precht'</span> &#125;,</div><div class="line">      &#123; name: <span class="string">'thoughtram'</span> &#125;</div><div class="line">    ];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  getItems() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.items;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>2.引入Service<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;DataService&#125; <span class="keyword">from</span> <span class="string">'dataService'</span>;</div></pre></td></tr></table></figure></p>
<p>3.绑定Service<br>有两种方法：<br>1.bootstrap绑定:<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bootstrap(<span class="name">Hello</span>, [DataService])<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>2.Component中使用bindings，见@Component</p>
<p>4.使用Service<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(dataService : DataService)</span> <span class="comment">&#123;</span></span></div><div class="line">  this.title = dataService.items[0].name;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>11.2  Service依赖<br>服务中需要引入依赖，以HTTP为例：<br>1.bootstrap文件<br>import {HTTP_BINDINGS} from ‘angular2/http’;<br>…<br>bootstrap(Hello , [HTTP_BINDINGS] );<br>2.服务文件<br>import {Injectable} from ‘angular2/core’;<br>import {Http} from ‘angular2/http’;<br>@Injectable()<br>export class DataService {<br>  constructor(http:Http) {…}<br>};<br>本文件另一种写法：<br>import {Http} from ‘angular2/http’;<br>import {Inject} from ‘angular2/angular2’;<br>export class DataService {<br>  constructor(@Inject(Http)  http:Http ) {…}<br>};<br>原文：<a href="http://blog.thoughtram.io/angular/2015/09/17/resolve-service-dependencies-in-angular-2.html" target="_blank" rel="external">http://blog.thoughtram.io/angular/2015/09/17/resolve-service-dependencies-in-angular-2.html</a></p>
<p>12  node_modules<br>systemjs - 通用模块加载器，支持AMD、CommonJS、ES6等各种格式的JS模块加载<br>es6-module-loader - ES6模块加载器，systemjs会自动加载这个模块<br>traceur - ES6转码器，将ES6代码转换为当前浏览器支持的ES5代码。systemjs会自动加载 这个模块。<br>13  实例<br>13.1  三种通信实例<br>本实例演示组件通信的三种方法：事件、服务、注入。提供源码。<br>三种方法的理解：事件<br>地址：<a href="https://github.com/SekibOmazic/angular2-playground" target="_blank" rel="external">https://github.com/SekibOmazic/angular2-playground</a><br>演示方法：<br>1下载源代码，点击Download Zip下载</p>
<p>2解压下载的ZIP文件<br>3命令行进入解压好的目录，npm i回车</p>
<p>4gulp play</p>
<p>5实际显示页面，三种通信方法</p>
<p>14  报错<br>Uncaught SyntaxError: Unexpected token &lt;<br>可能原因：ts文件未能成功编译成js文件，实际的错误提示是找不到js文件。<br>解决：templateUrl路径不对，或是错误使用``引号，应使用’’引号</p>
<p>EXCEPTION: Invalid argument XXXX for XXX ‘function () {}’ in [null]<br>可能原因：参数类型不符。<br>解决：重点检查传入参数的类型。</p>
<p>EXCEPTION: Cannot resolve all parameters for ClassName (Router, ?). Make sure they all have valid type or annotations. in [null]<br>可能原因：找不到class<br>解决：@Inject(forwardRef(()=&gt;ClassName)) classname: ClassName<br>参考：<a href="http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" rel="external">http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html</a></p>
<p>EXCEPTION: LifeCycle.tick is called recursively<br>可能原因：页面删除时focus状态未清除<br>解决：将focus设置到非动态focus的元素上</p>
<p>15  版本改变<br><a href="https://github.com/angular/angular/blob/master/CHANGELOG.md" target="_blank" rel="external">https://github.com/angular/angular/blob/master/CHANGELOG.md</a><br>16  参考资料<br>官方文档：<br><a href="https://angular.io/docs/js/latest/" target="_blank" rel="external">https://angular.io/docs/js/latest/</a><br><a href="https://github.com/angular/angular" target="_blank" rel="external">https://github.com/angular/angular</a><br><a href="https://github.com/timjacobi/angular2-education" target="_blank" rel="external">https://github.com/timjacobi/angular2-education</a></p>
</code>和<code></code>进行引用<br>6.5 ng-if<br>当*ng-if之后的表达式为true，则显示该HTML元素；反之则删除。显示删除过程会触发Lifecycle<br>例：<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  &lt;<span class="keyword">btv-player-menu </span>*ng-<span class="meta">if</span>=<span class="string">"isShowBtvPlayerMenu"</span>&gt;&lt;/<span class="keyword">btv-player-menu&gt;</span></div><div class="line">  &lt;<span class="keyword">btv-player-minidetail-page </span>*ng-<span class="meta">if</span>=<span class="string">"isShowBtvPlayerMinidetailPage"</span>&gt;&lt;/<span class="keyword">btv-player-minidetail-page&gt;</span></div><div class="line">  &lt;<span class="keyword">btv-player-reminder </span>*ng-<span class="meta">if</span>=<span class="string">"isShowBtvPlayerReminder"</span>&gt;&lt;/<span class="keyword">btv-player-reminder&gt;</span></div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>6.6 ng-switch</p>
<p>6.7 ng-model</p>
<p>6.8 ng-style<br>例1：<code>&lt;div [ng-style]=&quot;{&#39;background-image&#39;:&#39;url(&#39;+picture+&#39;)&#39;}&quot;&gt;&lt;/div&gt;</code> 背景图绑定picture变量，picture为图片地址<br>例2：<code>&lt;div [ng-style]=&quot;{&#39;text-align&#39;: alignExp}&quot;&gt;&lt;/div&gt;</code><br>例3：<code>&lt;div [ng-style]=&quot;styleExp&quot;&gt;&lt;/div&gt;</code>  可以是变量</p>
<p>6.9 ng-class<br>根据表达式的结果添加或移除CSS属性<br>例：<code>&lt;div class=&quot;button&quot; [ng-class]=&quot;{active: isOn, disabled: isDisabled}&quot;&gt;</code></p>
<p>6.10  ng-content<br><code>&lt;ng-content&gt;&lt;/ng-content&gt;</code>表明其它组件或内容插入当前组件的位置。<br>例：<code>&lt;zippy&gt;&lt;p&gt;111&lt;/p&gt;&lt;/zippy&gt;</code>，其中<code>&lt;p&gt;111&lt;/p&gt;</code>将插入zippy组件的template中的ng-content位置。</p>
<p>6.11  router-outlet<br>router的输出位置。</p>
<p>6.12  router-link<br>router-link表示跳转名称为search的地址，而不是跳转到/search的url下，见@RouteConfig。<br>有三种写法：<br>例1：<code>[router-link]=&quot;[&#39;./search&#39;]&quot;</code> search位于当前组件路径下<br>例2：<code>[router-link]=&quot;[&#39;../search&#39;]&quot;</code>  search位于当前组件的父路径下<br>例3：<code>[router-link]=&quot;[&#39;/search&#39;]&quot;</code>  绝对路径，从根路径开始<br>还可以传递参数：<br>例4：<code>[router-link] =”[&#39;/team&#39;, {teamId: 1}, &#39;user&#39;, {userId: 2}]”</code></p>
<p>6.13  Pipe<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Pipe&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>2.根据Pipe设定变量类型<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> starttime: number = <span class="number">0</span>;</div><div class="line"><span class="keyword">public</span> endtime: number = <span class="number">0</span>;</div><div class="line"><span class="keyword">this</span>.starttime = parseInt(<span class="keyword">this</span>.playbilllist.playbilllist[<span class="number">0</span>].startTimeMilli);</div><div class="line"><span class="keyword">this</span>.endtime = parseInt(<span class="keyword">this</span>.playbilllist.playbilllist[<span class="number">0</span>].endTimeMilli);</div></pre></td></tr></table></figure></p>
<p>3.使用Pipe设定时间<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">div</span>&gt;&#123;&#123;starttime | <span class="keyword">date</span>:<span class="string">'HHmm'</span>&#125;&#125; - &#123;&#123;endtime | <span class="keyword">date</span>:<span class="string">'HHmm'</span>&#125;&#125;&lt;/<span class="keyword">div</span>&gt;</div></pre></td></tr></table></figure></p>
<p>参考：<br><a href="http://www.shmck.com/angular-2-pipes/" target="_blank" rel="external">http://www.shmck.com/angular-2-pipes/</a><br><a href="https://github.com/auth0/angular2-pipes" target="_blank" rel="external">https://github.com/auth0/angular2-pipes</a></p>
<p>7 bootstrap<br>启动Main程序，[]中的绑定将全局可用<br>例：bootstrap(App, []);<br>8 inject<br>1.template中，注入的类为父子关系<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;pet-list &gt;</span></div><div class="line"><span class="section">&lt;pet-input&gt;</span><span class="section">&lt;/pet-input&gt;</span></div><div class="line"><span class="section">&lt;/pet-list&gt;</span></div></pre></td></tr></table></figure></p>
<p>2.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;PetList&#125; <span class="keyword">from</span> <span class="string">'byinjection/PetList'</span>;</div><div class="line"><span class="keyword">import</span> &#123; <span class="keyword">Inject</span>, forwardRef&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>3.class注入，调用注入class的方法<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">export <span class="class"><span class="keyword">class</span> <span class="title">PetInput</span> </span>&#123;</div><div class="line">  petList: PetList;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>(<span class="meta">@Inject(forwardRef(()</span>=&gt;PetList)) petList:PetList) &#123; <span class="comment">//petList为单例，指向dom树中的&lt;pet-list&gt;</span></div><div class="line">    <span class="keyword">this</span>.petList = petList;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  doSomeThing()&#123;</div><div class="line">  <span class="keyword">this</span>.petList.addItem(...); <span class="comment">//调用petList的方法，可以传参</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>参考：<br><a href="https://github.com/SekibOmazic/angular2-playground" target="_blank" rel="external">https://github.com/SekibOmazic/angular2-playground</a><br><a href="http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" rel="external">http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html</a></p>
<p>9 事件<br>9.1 系统事件<br>click事件<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div (<span class="name">click</span>)=<span class="string">"toggle()"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>(click)监听click事件<br>toggle()事件触发函数<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="selector-tag">div</span> [hidden]=<span class="string">"!visible"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>[hidden] 中括号将HTML元素或组件的属性绑定到组件模型的某个表达式，当表达式的值变化时，对应的DOM对象将自动得到更新。<br>visible为对应class中定义的变量<br>keyup事件<br>例：<code>&lt;input class=&quot;form-control&quot; type=&quot;text&quot; placeholder=&quot;Your new friend&quot; #friend (keyup) =&quot;update(friend.value)&quot;&gt;</code><br>键盘事件<br>1.document方法：<br>将下面代码加入class的constructor中<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (event.keyCode) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">38</span>:</div><div class="line">      alert(<span class="string">'clear'</span>);</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2.window方法：<br>将下面代码加入class的constructor中</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"keydown"</span>,<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="regexp">//</span><span class="number">1</span>、显示miniepg</div><div class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.event &amp;&amp; <span class="built_in">window</span>.event.which === <span class="number">73</span>) &#123;</div><div class="line"><span class="keyword">this</span>.showFlag = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line">&#125;, <span class="literal">true</span>);</div></pre></td></tr></table></figure>
<p>3.Angular2方法：<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;KeyEventsPlugin&#125; <span class="keyword">from</span> <span class="string">'angular2/src/core/render/dom/events/key_events'</span>;</div></pre></td></tr></table></figure></p>
<p>2.template中修改需要加入键盘事件的HTML元素，使用时该元素要先获得焦点<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div (<span class="name">keyup</span>) =<span class="string">"onKeyDown($event)"</span> tabindex=<span class="string">"0"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>3.class中加入以下方法，取得的lastKey为字符串<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">onKeyDown(<span class="keyword">event</span>): <span class="keyword">void</span> &#123;</div><div class="line">  <span class="keyword">this</span>.lastKey = KeyEventsPlugin.getEventFullKey(<span class="keyword">event</span>);</div><div class="line">  <span class="keyword">event</span>.preventDefault();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>9.2 自定义事件<br>1.引入依赖<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Component, View, EventEmitter&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>2.@Component声明<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@Component</span>(&#123;</div><div class="line">    <span class="attribute">selector</span>: <span class="string">'zippy'</span>,</div><div class="line">    <span class="attribute">events</span>: [<span class="string">'open'</span>, <span class="string">'close'</span>]</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>3.class类里定义事件变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Zippy</span> </span>&#123;</div><div class="line"><span class="keyword">constructor</span>() &#123;</div><div class="line">  <span class="keyword">this</span>.open = <span class="keyword">new</span> EventEmitter();</div><div class="line">  <span class="keyword">this</span>.close = <span class="keyword">new</span> EventEmitter();&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>4.触发方法<br>toggle()方法执行，将触发事件：<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">toggle() &#123;</div><div class="line">      (<span class="keyword">this</span>.visible)?<span class="keyword">this</span>.<span class="keyword">open</span>.next(&#123;src:’<span class="number">111</span>’&#125;):<span class="keyword">this</span>.close.next();</div><div class="line">    &#125;</div><div class="line">&#123;src:’<span class="number">111</span>’&#125;为事件传参，在下面的$event会收到这个参数</div></pre></td></tr></table></figure></p>
<p>5.使用该组件事件<br><figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;zippy (<span class="keyword">open</span>)=<span class="string">"sayOpen($event)"</span> (<span class="keyword">close</span>)=<span class="string">"sayClose()"</span>&gt;&lt;/zippy&gt;</div><div class="line"><span class="built_in">$event</span>为事件传入参数</div></pre></td></tr></table></figure></p>
<p>(open)可写为on-open，(close)可写为on-close</p>
<p>事件从组件内部发送到组件上，从而可以调用其它组件的方法：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">gadget-input</span> (<span class="attr">store</span>)=<span class="string">"gadget.onAddItem($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">gadget-input</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">gadget-list</span> #<span class="attr">gadget</span>&gt;</span><span class="tag">&lt;/<span class="name">gadget-list</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>9.3 Observer事件<br>1.引用依赖<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;ObservableComponent&#125; <span class="keyword">from</span> <span class="string">'base/core/ObservableComponent'</span>;</div><div class="line"><span class="keyword">import</span> &#123;Event&#125; <span class="keyword">from</span> <span class="string">'base/core/Event'</span>;</div></pre></td></tr></table></figure></p>
<p>2.定义一个类<br>重写listNotificationInterests，返回一个数组包括所有事件名<br>用Event.getInstance().on方法设置所有事件的回调函数<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyEvent</span> <span class="keyword">extends</span> <span class="title">ObservableComponent</span>&#123;</span></div><div class="line">  constructor()&#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="keyword">super</span>.onInit();</div><div class="line">    Event.getInstance().<span class="literal">on</span>(<span class="string">"aaa"</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">"I'm aaa"</span>) &#125;);</div><div class="line">    Event.getInstance().<span class="literal">on</span>(<span class="string">"bbb"</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">"I'm bbb"</span>) &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  listNotificationInterests() &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">"aaa"</span>, <span class="string">"bbb"</span>];</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3.生成一个实例<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(iptvService: IptvService)</span> <span class="comment">&#123;</span></span></div><div class="line">    this.MyEvent = new MyEvent();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4.调用函数发事件<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">emitTest</span>()&#123;</div><div class="line">    Event<span class="selector-class">.getInstance</span>()<span class="selector-class">.emit</span>(<span class="string">"bbb"</span>);</div><div class="line">    Event<span class="selector-class">.getInstance</span>()<span class="selector-class">.emit</span>(<span class="string">"aaa"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>9.4 Lifecycle<br>Lifecycle可以看作是组件自带的系统事件，在组件运行的关键时间点可添加处理函数，alpha.37改为如下写法请注意。<br>例：<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;OnInit, OnDestroy&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div></pre></td></tr></table></figure></p>
<p>2.重写相关Lifecycle方法<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">export</span> <span class="selector-tag">class</span> <span class="selector-tag">About</span> <span class="selector-tag">implements</span> <span class="selector-tag">OnInit</span>, <span class="selector-tag">OnDestroy</span> &#123;</div><div class="line">  <span class="selector-tag">onInit</span>()&#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="selector-tag">onDestroy</span>()&#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>10  Router<br>10.1  router策略<br><code>bind(LocationStrategy).toClass(HashLocationStrategy)</code> 使用hash url定位策略<br><code>bind(LocationStrategy).toClass(PathLocationStrategy)</code> 需在index.html的<head>中加入<base href="/"></head></p>
<p>10.2  @RouteConfig<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RouteConfig</span>([</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/'</span>, <span class="string">redirectTo:</span> <span class="string">'/search'</span> &#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/search'</span>, <span class="string">as:</span> <span class="string">'search'</span>, <span class="string">component:</span> Search &#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/artist/:id'</span>, <span class="string">as:</span> <span class="string">'artist'</span>, <span class="string">component:</span> Artist &#125;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<p>path: ‘/‘为默认路径。<br>redirectTo：跳转到其它路径<br>as：路径的别名，用于[router-link]中引用<br>component：引用的组件类名</p>
<p>10.3  router设置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span><span class="keyword">import</span> &#123; ROUTER_BINDINGS, LocationStrategy, HashLocationStrategy, PathLocationStrategy &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123;bind&#125; <span class="keyword">from</span> <span class="string">'angular2/angular2'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ROUTER_DIRECTIVES, RouteConfig, RouterLink &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div><div class="line">bootstrap(App, [ROUTER-BINDINGS, bind(LocationStrategy).toClass(HashLocationStrategy)]);</div><div class="line"></div><div class="line"><span class="number">2.</span>@RouteConfig([</div><div class="line">    &#123;path:<span class="string">'/'</span>, component:Start, <span class="keyword">as</span>: <span class="string">'start'</span>&#125;</div><div class="line">])</div><div class="line"><span class="number">3.</span>&lt;router-outlet&gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span></div><div class="line">directives: [ROUTER_DIRECTIVES, RouterLink]</div><div class="line"></div><div class="line">4.<span class="tag">&lt;<span class="name">a</span> [<span class="attr">router-link</span>]=<span class="string">"['./user']"</span>&gt;</span>link to user component<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>10.4  router跳转<br>1.import<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;Router&#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div></pre></td></tr></table></figure></p>
<p>2.constructor注入<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(..., <span class="keyword">public</span> router: Router)</span> <span class="comment">&#123;</span></span></div><div class="line">    ...</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>url跳转方法<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.router.navigateByUrl(<span class="string">'/home/livetv'</span>);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>10.5  父子路由<br>1、  针对父—子路由：<br>父路由配置（在父ts文件下）：<br>  （1）、导入路由所需组件：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Router, RouteConfig, ROUTER_DIRECTIVES, ROUTER_BINDINGS &#125; <span class="keyword">from</span> <span class="string">'angular2/router'</span>;</div></pre></td></tr></table></figure></p>
<p>  （2）、配置路由：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RouteConfig</span>([</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/'</span>, <span class="string">redirectTo:</span> <span class="string">'/login/userlogin'</span> &#125;,   <span class="comment">// redirectTo默认页面</span></div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/login/...'</span>, <span class="string">component:</span> Login, <span class="string">as:</span> <span class="string">'login'</span> &#125;,  <span class="comment">// component为导入的组件</span></div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/mytvNavigation/...'</span>, <span class="string">component:</span> MyTVNavigation, <span class="string">as:</span> <span class="string">'mytvNavigation'</span> &#125;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<p>子路由配置（子ts文件中）：<br>  （1）、同上；<br>  （2）、配置路由：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RouteConfig</span>([</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/mytvNavigation'</span>, <span class="string">redirectTo:</span> <span class="string">'/history'</span>&#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/history'</span>, <span class="string">component:</span> History, <span class="string">as:</span> <span class="string">'history'</span>&#125;,</div><div class="line">  &#123; <span class="string">path:</span> <span class="string">'/favorite'</span>, <span class="string">component:</span> Favorite, <span class="string">as:</span> <span class="string">'favorite'</span> &#125;,</div><div class="line">&#123; <span class="string">path:</span> <span class="string">'/profile/...'</span>, <span class="string">component:</span> Profile, <span class="string">as:</span> <span class="string">'profile'</span>&#125;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<p>其中path最好写上父路由路径，如果不写，在页面跳转时要加上父路径的path。<br>如果子路由下还存在子路由（如profile），以此类推……<br>注：凡是配置路由的ts文件，其<code>@View{}</code>中必须配置路由出口<code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>，否则即使url地址变化，页面内容还是显示不出或者跳转不了！！！！<br>路由出口需要的组件：ROUTER_DIRECTIVES / RouterOutlet</p>
<p>11  Service服务<br>service是单例，数据共享给所有使用者<br>11.1  自定义Service<br>使用服务的4步，包括定义、引入、绑定、使用<br>1.定义Service<br>在angular2中，服务就是一个类。例：自定义一个简单的服务：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">DataService</span> </span>&#123;</div><div class="line">  items:<span class="built_in">Array</span>&lt;any&gt;;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.items = [</div><div class="line">      &#123; name: <span class="string">'Christoph Burgdorf'</span> &#125;,</div><div class="line">      &#123; name: <span class="string">'Pascal Precht'</span> &#125;,</div><div class="line">      &#123; name: <span class="string">'thoughtram'</span> &#125;</div><div class="line">    ];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  getItems() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.items;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>2.引入Service<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;DataService&#125; <span class="keyword">from</span> <span class="string">'dataService'</span>;</div></pre></td></tr></table></figure></p>
<p>3.绑定Service<br>有两种方法：<br>1.bootstrap绑定:<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bootstrap(<span class="name">Hello</span>, [DataService])<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>2.Component中使用bindings，见@Component</p>
<p>4.使用Service<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">constructor</span><span class="params">(dataService : DataService)</span> <span class="comment">&#123;</span></span></div><div class="line">  this.title = dataService.items[0].name;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>11.2  Service依赖<br>服务中需要引入依赖，以HTTP为例：<br>1.bootstrap文件<br>import {HTTP_BINDINGS} from ‘angular2/http’;<br>…<br>bootstrap(Hello , [HTTP_BINDINGS] );<br>2.服务文件<br>import {Injectable} from ‘angular2/core’;<br>import {Http} from ‘angular2/http’;<br>@Injectable()<br>export class DataService {<br>  constructor(http:Http) {…}<br>};<br>本文件另一种写法：<br>import {Http} from ‘angular2/http’;<br>import {Inject} from ‘angular2/angular2’;<br>export class DataService {<br>  constructor(@Inject(Http)  http:Http ) {…}<br>};<br>原文：<a href="http://blog.thoughtram.io/angular/2015/09/17/resolve-service-dependencies-in-angular-2.html" target="_blank" rel="external">http://blog.thoughtram.io/angular/2015/09/17/resolve-service-dependencies-in-angular-2.html</a></p>
<p>12  node_modules<br>systemjs - 通用模块加载器，支持AMD、CommonJS、ES6等各种格式的JS模块加载<br>es6-module-loader - ES6模块加载器，systemjs会自动加载这个模块<br>traceur - ES6转码器，将ES6代码转换为当前浏览器支持的ES5代码。systemjs会自动加载 这个模块。<br>13  实例<br>13.1  三种通信实例<br>本实例演示组件通信的三种方法：事件、服务、注入。提供源码。<br>三种方法的理解：事件<br>地址：<a href="https://github.com/SekibOmazic/angular2-playground" target="_blank" rel="external">https://github.com/SekibOmazic/angular2-playground</a><br>演示方法：<br>1下载源代码，点击Download Zip下载</p>
<p>2解压下载的ZIP文件<br>3命令行进入解压好的目录，npm i回车</p>
<p>4gulp play</p>
<p>5实际显示页面，三种通信方法</p>
<p>14  报错<br>Uncaught SyntaxError: Unexpected token &lt;<br>可能原因：ts文件未能成功编译成js文件，实际的错误提示是找不到js文件。<br>解决：templateUrl路径不对，或是错误使用``引号，应使用’’引号</p>
<p>EXCEPTION: Invalid argument XXXX for XXX ‘function () {}’ in [null]<br>可能原因：参数类型不符。<br>解决：重点检查传入参数的类型。</p>
<p>EXCEPTION: Cannot resolve all parameters for ClassName (Router, ?). Make sure they all have valid type or annotations. in [null]<br>可能原因：找不到class<br>解决：@Inject(forwardRef(()=&gt;ClassName)) classname: ClassName<br>参考：<a href="http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" rel="external">http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html</a></p>
<p>EXCEPTION: LifeCycle.tick is called recursively<br>可能原因：页面删除时focus状态未清除<br>解决：将focus设置到非动态focus的元素上</p>
<p>15  版本改变<br><a href="https://github.com/angular/angular/blob/master/CHANGELOG.md" target="_blank" rel="external">https://github.com/angular/angular/blob/master/CHANGELOG.md</a><br>16  参考资料<br>官方文档：<br><a href="https://angular.io/docs/js/latest/" target="_blank" rel="external">https://angular.io/docs/js/latest/</a><br><a href="https://github.com/angular/angular" target="_blank" rel="external">https://github.com/angular/angular</a><br><a href="https://github.com/timjacobi/angular2-education" target="_blank" rel="external">https://github.com/timjacobi/angular2-education</a></p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/12/29/screenshot/" rel="next" title="截图工具">
                <i class="fa fa-chevron-left"></i> 截图工具
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/01/10/dota2/" rel="prev" title="ubuntu下玩dota2">
                ubuntu下玩dota2 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="亚木" />
          <p class="site-author-name" itemprop="name">亚木</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">31</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">亚木</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  

</body>
</html>
